{% extends "base.html" %}

{% block content %}
<div class="form-container">
    <h2>‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–æ–π #{{ ticket.id }}</h2>
    
    <div class="ticket-preview">
        <h3>{{ ticket.title }}</h3>
        <p>{{ ticket.description }}</p>
        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> 
            <span class="status-badge status-{{ ticket.status.value }}">
                {% if ticket.status.value == 'open' %}üî¥ –û—Ç–∫—Ä—ã—Ç–∞
                {% elif ticket.status.value == 'in_progress' %}üü° –í —Ä–∞–±–æ—Ç–µ
                {% else %}üü¢ –ó–∞–∫—Ä—ã—Ç–∞{% endif %}
            </span>
        </p>
    </div>

    {% if ticket.status.value == 'open' %}
    <div class="action-section">
        <h3>üì• –ü—Ä–∏–Ω—è—Ç—å –∑–∞—è–≤–∫—É –≤ —Ä–∞–±–æ—Ç—É</h3>
        <form method="POST">
            <input type="hidden" name="action" value="assign">
            <button type="submit" class="btn btn-warning">–ü—Ä–∏–Ω—è—Ç—å –∑–∞—è–≤–∫—É</button>
        </form>
    </div>
    {% endif %}

    {% if ticket.status.value == 'in_progress' %}
    <div class="action-section">
        <h3>‚úÖ –ó–∞–∫—Ä—ã—Ç—å –∑–∞—è–≤–∫—É</h3>
        <form method="POST">
            <input type="hidden" name="action" value="close">
            
            <div class="form-group">
                <label for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∑–∞–∫—Ä—ã—Ç–∏—è:</label>
                <textarea id="comment" name="comment" rows="4" required
                          placeholder="–û–ø–∏—à–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã..."></textarea>
            </div>
            
            <button type="submit" class="btn btn-success">–ó–∞–∫—Ä—ã—Ç—å –∑–∞—è–≤–∫—É</button>
        </form>
    </div>
    {% endif %}

    {% if ticket.status.value == 'closed' %}
    <div class="alert alert-info">
        ‚úÖ –≠—Ç–∞ –∑–∞—è–≤–∫–∞ —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞
    </div>
    {% endif %}

    <div class="action-buttons">
        <a href="{{ url_for('ticket_detail', ticket_id=ticket.id) }}" 
           class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –∫ –∑–∞—è–≤–∫–µ</a>
    </div>
</div>
{% endblock %}