{% extends "base.html" %}

{% block content %}
<div class="ticket-detail">
    <div class="ticket-header">
        <h2>–ó–∞—è–≤–∫–∞ #{{ ticket.id }}</h2>
        <span class="status-badge status-{{ ticket.status.value }} large">
            {% if ticket.status.value == 'open' %}üî¥ –û—Ç–∫—Ä—ã—Ç–∞
            {% elif ticket.status.value == 'in_progress' %}üü° –í —Ä–∞–±–æ—Ç–µ
            {% else %}üü¢ –ó–∞–∫—Ä—ã—Ç–∞{% endif %}
        </span>
    </div>

    <div class="ticket-content">
        <div class="detail-section">
            <h3>üìÑ –û–ø–∏—Å–∞–Ω–∏–µ</h3>
            <div class="detail-card">
                <h4>{{ ticket.title }}</h4>
                <p class="description-text">{{ ticket.description }}</p>
            </div>
        </div>

        <div class="detail-grid">
            <div class="detail-card">
                <h4>üë§ –°–æ–∑–¥–∞—Ç–µ–ª—å</h4>
                <p>{{ created_by.name if created_by else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' }}</p>
            </div>
            
            <div class="detail-card">
                <h4>üìÖ –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</h4>
                <p>{{ ticket.created_at.strftime('%d.%m.%Y %H:%M') }}</p>
            </div>
            
            {% if ticket.responsible_person_id %}
            <div class="detail-card">
                <h4>üëî –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</h4>
                <p>{{ responsible.name if responsible else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' }}</p>
            </div>
            {% endif %}
            
            {% if ticket.status.value == 'closed' %}
            <div class="detail-card">
                <h4>‚úÖ –î–∞—Ç–∞ –∑–∞–∫—Ä—ã—Ç–∏—è</h4>
                <p>{{ ticket.closed_at.strftime('%d.%m.%Y %H:%M') }}</p>
            </div>
            
            <div class="detail-card full-width">
                <h4>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏</h4>
                <p class="comment-text">{{ ticket.closing_comment }}</p>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="action-buttons">
        <a href="{{ url_for('tickets_list') }}" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
        
        {% if ticket.status.value != 'closed' %}
        <a href="{{ url_for('manage_ticket', ticket_id=ticket.id) }}" 
           class="btn btn-warning">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–æ–π</a>
        {% endif %}
    </div>
</div>
{% endblock %}