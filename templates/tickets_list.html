{% extends "base.html" %}

{% block content %}
<h2>ğŸ“‹ Ğ’ÑĞµ Ğ·Ğ°ÑĞ²ĞºĞ¸</h2>

<!-- Ğ¡Ñ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° -->
<div class="stats-grid">
    <div class="stat-card status-open">
        <span class="stat-number">{{ open_tickets|length }}</span>
        <span class="stat-label">ğŸ”´ ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ</span>
    </div>
    <div class="stat-card status-in_progress">
        <span class="stat-number">{{ in_progress_tickets|length }}</span>
        <span class="stat-label">ğŸŸ¡ Ğ’ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ</span>
    </div>
    <div class="stat-card status-closed">
        <span class="stat-number">{{ closed_tickets|length }}</span>
        <span class="stat-label">ğŸŸ¢ Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ</span>
    </div>
</div>

{% if tickets %}
<div class="tickets-grid">
    {% for ticket in tickets %}
    <div class="ticket-card status-{{ ticket.status.value }}">
        <div class="ticket-header">
            <span class="ticket-id">#{{ ticket.id }}</span>
            <span class="status-badge status-{{ ticket.status.value }}">
                {% if ticket.status.value == 'open' %}ğŸ”´ ĞÑ‚ĞºÑ€Ñ‹Ñ‚Ğ°
                {% elif ticket.status.value == 'in_progress' %}ğŸŸ¡ Ğ’ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ
                {% else %}ğŸŸ¢ Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚Ğ°{% endif %}
            </span>
        </div>
        
        <h3 class="ticket-title">{{ ticket.title }}</h3>
        <p class="ticket-description">{{ ticket.description[:100] }}{% if ticket.description|length > 100 %}...{% endif %}</p>
        
        <div class="ticket-meta">
            <small>ğŸ“… {{ ticket.created_at.strftime('%d.%m.%Y %H:%M') }}</small>
        </div>
        
        <div class="ticket-actions">
            <a href="{{ url_for('ticket_detail', ticket_id=ticket.id) }}" 
               class="btn btn-small">ğŸ‘€ ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½ĞµĞµ</a>
            
            {% if ticket.status.value != 'closed' %}
            <a href="{{ url_for('manage_ticket', ticket_id=ticket.id) }}" 
               class="btn btn-small btn-warning">âš™ï¸ Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ</a>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <p>ğŸ˜´ Ğ—Ğ°ÑĞ²Ğ¾Ğº Ğ¿Ğ¾ĞºĞ° Ğ½ĞµÑ‚</p>
    <a href="{{ url_for('create_ticket') }}" class="btn btn-primary">Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿ĞµÑ€Ğ²ÑƒÑ Ğ·Ğ°ÑĞ²ĞºÑƒ</a>
</div>
{% endif %}
{% endblock %}